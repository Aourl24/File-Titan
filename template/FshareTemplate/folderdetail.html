{%extends 'base.html'%}

{%block content%}
<style>
    .back {
        background-color: white;
        width: 100%;
        height: 100%;
    }
    @media(min-width:600px) {
        inut {
            width: 100%
        }
    }
</style>
<div class="">
    <div class="row color-black sz-12" style="">
        {%if file.cover_phoo%}
        <img class="container-fluid p-0 my-2" src="{{file.cover_photo.url}}" style="height:150px;width:100%;object-fit:cover;object-position:top"/>
        {%else%}
        <div class="container-fluid p-0 m-0 justify-content-center d-flex align-items-center" style="height:100px;width:100%;object-fit:cover;object-position:top">
            <i class="fas fa-folder-open sz-48">
            </i>
        </div>
        {%endif%}
        <div class="col-md-12 col-sm-12 center my-2">
            {%if file.parent%}
            <a class="normal color-s" href="{{file.parent.get_absolute_url}}">
                {{file.parent.name}}
            </a>
            {%endif%}
            <b style="font-size:20px">
                {{file.name|title }}
            </b>
        </div>
        
</div>
        {%if file.info%}
            <div class="row center color-grey">
                <div class="col sz-14">
                    {{file.info}}
                </div>
            </div>
        {%endif%}
<div class="row">
        <div class="col-md col-sm-12 center sz-12">
            <div class="btn btn-link sz-sm p-0 color-s" hx-get="{%url 'DownloadUrl' file.id%}" hx-swap="outerHTML" style="">
                <i class="fas fa-download">
                </i>
                Download this Folder
                <div class="htmx-indicator hide" style="position:absolute;">
                    wait...
                    <div class="circle rotate" style="position:absolute;border-bottom:2px solid blue;border-right:2px solid blue;border-left:2px solid white;border-top:2px solid white;height:15px;width:15px">
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md col-sm-12 center passive sz-12">
                <span class="color-s">
                    {{originalFile.count}}
                </span>
                files |
                <span class="color-s">
                    {{file.child_folder.count}}
                </span>
                folders
                <span class="desize black" style="">
                    <span class="passive">
                        | owner
                    </span>
                    <a href="{{file.owner.get_absolute_url}}">
                        <span class="bold color-s">
                            {{file.owner.user.username|title|truncatechars:'5'}}
                        </span>
                    </a>
                </span>
        </div>
    </div>

        {%if file.owner == prof %}
       <div class="row">
        <div class="col-md col center ">
            <a class="sz-sm text-danger color-white sz-12" href="{%url 'EditFolderUrl' file.id request.path_info%}">
                edit
            </a>
        </div>
        <a class="col-md col sz-sm text-danger center" href="{%url 'FolderDeleteUrl' file.id%}">
            delete
        </a>
    </div>
        {%endif%}
    
    {%if not folder.parent%}
    <div class="row sz-12 my-3 center">
        {%include 'FshareTemplate/like.html' with folder=file%}
    </div>
    {%endif%}
    <hr/>
    
   <div class='row align-items-center justify-content-center my-2'>
     <div class='col sz-12 color-p' style='text-algn:right'>sort files by </div>
     <div class='col'>
    
    <select hx-get="{%url 'SortUrl' file.id True %}" hx-target='#holder' hx-swap='innerHTML' name='filter' class='form-conrol sz-12 btn btn-default no-boder'>
      
     <option value='name'>Name</option>
      <option value='date_created'>Date Created</option>
      <option value='file'>Size</option>
    </select>
    
    </div>
    </div>
    <hr />
<div class="row m-2" id="holder">
    {%include 'FshareTemplate/folderlist.html' with folders=file.child_folder.all %}



{%include 'FshareTemplate/file.html'%}

</div>
{%if file.owner == prof %}
    <div class="bottom-side rounded-circle color-bg-p p-3 m-2" onclick="$('#createbox').fadeToggle()" style="bordr-radius:20px;z-index:5000;right:10px;bottom:30px">
        <i class="fas fa-pen sz-24">
        </i>
    </div>
    {%endif%}
    <div class="modal sz-18 swap" id="createbox" style="z-index:4000;width:100%;heiht:170px;tp:20%;background-color:rgba(300,300,300,0.9
)">
        <div class="modal-dialog modal-dialog-centered ">
            <div class="modal-content no-border" syle="top:50px;width:100%">

                <div class="row my-2">
                    <div class="col-12">
                        <button class="btn color-bg-s color-white" onclick="$('.swap').fadeOut();$('#create').fadeIn()">
                            <div class="sz-16">
                                Create New File
                            </div>
                        </button>
                    </div>
                </div>

                <div class="row my-2">
                    <div class="col">
                        <button class="btn color-bg-p color-white" onclick="$('.swap').fadeOut();$('#newfile').fadeIn()">
                            <div class="sz-16">
                                Upload Files
                            </div>
                        </button>
                    </div>
                </div>
                <div class="row my-2">
                    <div class="col">
                        <button class="btn btn-success" onclick="$('.swap').fadeOut();$('#newfolder').fadeIn()">
                            <div class="sz-16">
                                Create New Folder
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="modal sz-18 swap" id="create" style="z-index:4000;width:100%;heiht:170px;tp:20%;background-color:rgba(300,300,300,0.9
)">
        <div class="modal-dialog modal-dialog-centered ">
            <div class="modal-content no-border" syle="top:50px;width:100%">
                    <form action="{%url 'CreateUrl' %}" class="alert p-3 ronded bg-light" method="post">
                        {%csrf_token%}
                        <div class="row sz-24 m-2 my-3 color-p">
                            New File
                        </div>

                        <div class="row m-2">
                        <input name="folderid" style="" type="hidden" value="{{file.id}}" />
                            <input class="form-control sz-18" name="filename" placeholder="name" required="" style="" />
                        </div>
                        <div class="row m-2">
                                <button class="form-control btn color-bg-p w-100 btn-block color-white sz-16">
                                    Create
                                </button>
                        </div>
                                <div class="btn btn-link btn-block text-danger row m-2 w-100 sz-16" onclick="$('#create').fadeOut()">
                                    close window
                                </div>
                    </form>
            </div>
        </div>
    </div>


    <div class="modal sz-18 swap" id="newfile" style="z-index:4000;width:100%;heiht:170px;tp:20%;background-color:rgba(300,300,300,0.9
)">
        <div class="modal-dialog modal-dialog-centered ">
            <div class="modal-content no-border" syle="top:50px;width:100%">
                    <form action="{%url 'FileFormUrl' %}" class="alert p-2 ronded bg-light" enctype="multipart/form-data" id="newfile" method="POST" style="">
                        <div class="row m-2 sz-24 color-p my-3">
                            Upload Files
                        </div>
                        <input class="input" name="folder" type="hidden" value="{{file.id}}" />
                            {%csrf_token%}
           {%comment%}

            {%for f in fileForm%}
            {{f.as_widget}}
            {%endfor%}
            {%endcomment%}
            <div class="row m-2">
                            <input class="form-control sz-18" multiple="" name="file" type="file"/>
            </div>
                            <div class="row m-2"><button class="btn btn-block color-bg-s color-white w-100 sz-16">
                                Upload
                            </button></div>
                            <div class="row m-2 btn btn-link btn-block text-danger w-100 sz-16" onclick="$('#newfile').fadeOut()">
                                close window
                            </div>
                    </form>
            </div>
        </div>
    </div>
    <div class="modal sz-18 swap" id="newfolder" style="z-index:4000;width:100%;heiht:170px;tp:20%;background-color:rgba(300,300,300,0.9
);">
        <div class="modal-dialog modal-dialog-centered ">
            <div class="modal-content no-border" style="overflow:auto">
                <br />

                    {% include 'FshareTemplate/folderform.html' with title='create' %}
                    <p class="btn btn-link btn-block text-danger sz-16" onclick="$('#newfolder').fadeOut()">
                        close window
                    </p>

            </div>
        </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function() {
$('#fle').attr({
'webkitdirectory': false, 'directory': false
});
$('#fle').removeAttr('webkitdirectory');
$('#fle').removeAttr('directory')
}
)
    </script>
</div>
<br>
    {%endblock%}
</br>